# OTLPæ–‡æ¡£è´¨é‡æ£€æŸ¥å·¥å…·

## ðŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›äº†OTLP Rusté¡¹ç›®æ–‡æ¡£è´¨é‡æ£€æŸ¥çš„å·¥å…·å’Œæ–¹æ³•ï¼Œç¡®ä¿æ–‡æ¡£çš„å‡†ç¡®æ€§ã€å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚

**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ27æ—¥
**å·¥å…·ç‰ˆæœ¬**: v1.0
**é€‚ç”¨èŒƒå›´**: æ‰€æœ‰é¡¹ç›®æ–‡æ¡£

## ðŸ› ï¸ æ£€æŸ¥å·¥å…·

### 1. é“¾æŽ¥æ£€æŸ¥å·¥å…·

#### 1.1 markdown-link-check

```bash
# å®‰è£…
npm install -g markdown-link-check

# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
markdown-link-check README.md

# æ£€æŸ¥æ‰€æœ‰markdownæ–‡ä»¶
find . -name "*.md" -exec markdown-link-check {} \;

# æ£€æŸ¥å¹¶å¿½ç•¥å¤–éƒ¨é“¾æŽ¥
markdown-link-check README.md --ignore "https://"
```

#### 1.2 è‡ªå®šä¹‰é“¾æŽ¥æ£€æŸ¥è„šæœ¬

```bash
#!/bin/bash
# link_checker.sh

echo "å¼€å§‹æ£€æŸ¥æ–‡æ¡£é“¾æŽ¥..."

# æ£€æŸ¥å†…éƒ¨é“¾æŽ¥
echo "æ£€æŸ¥å†…éƒ¨é“¾æŽ¥..."
find . -name "*.md" -exec grep -l "\[.*\](.*\.md)" {} \; | while read file; do
    echo "æ£€æŸ¥æ–‡ä»¶: $file"
    grep -o "\[.*\](.*\.md)" "$file" | while read link; do
        target=$(echo "$link" | sed 's/.*(\(.*\))/\1/')
        if [ ! -f "$target" ]; then
            echo "é”™è¯¯: $file ä¸­çš„é“¾æŽ¥ $link æŒ‡å‘ä¸å­˜åœ¨çš„æ–‡ä»¶ $target"
        fi
    done
done

# æ£€æŸ¥å¤–éƒ¨é“¾æŽ¥
echo "æ£€æŸ¥å¤–éƒ¨é“¾æŽ¥..."
find . -name "*.md" -exec grep -l "https://" {} \; | while read file; do
    echo "æ£€æŸ¥æ–‡ä»¶: $file"
    grep -o "https://[^)]*" "$file" | while read url; do
        if ! curl -s --head "$url" | head -n 1 | grep -q "200 OK"; then
            echo "è­¦å‘Š: $file ä¸­çš„é“¾æŽ¥ $url å¯èƒ½æ— æ³•è®¿é—®"
        fi
    done
done

echo "é“¾æŽ¥æ£€æŸ¥å®Œæˆ"
```

### 2. æ ¼å¼æ£€æŸ¥å·¥å…·

#### 2.1 markdownlint

```bash
# å®‰è£…
npm install -g markdownlint-cli

# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
markdownlint README.md

# æ£€æŸ¥æ‰€æœ‰markdownæ–‡ä»¶
markdownlint "**/*.md"

# ä½¿ç”¨é…ç½®æ–‡ä»¶
markdownlint -c .markdownlint.json "**/*.md"
```

#### 2.2 è‡ªå®šä¹‰æ ¼å¼æ£€æŸ¥è„šæœ¬

```bash
#!/bin/bash
# format_checker.sh

echo "å¼€å§‹æ£€æŸ¥æ–‡æ¡£æ ¼å¼..."

# æ£€æŸ¥æ ‡é¢˜å±‚çº§
echo "æ£€æŸ¥æ ‡é¢˜å±‚çº§..."
find . -name "*.md" -exec grep -n "^#" {} \; | while read line; do
    file=$(echo "$line" | cut -d: -f1)
    line_num=$(echo "$line" | cut -d: -f2)
    content=$(echo "$line" | cut -d: -f3-)

    # æ£€æŸ¥æ ‡é¢˜æ ¼å¼
    if [[ ! "$content" =~ ^#+\ + ]]; then
        echo "é”™è¯¯: $file:$line_num æ ‡é¢˜æ ¼å¼ä¸æ­£ç¡®: $content"
    fi
done

# æ£€æŸ¥ä»£ç å—æ ¼å¼
echo "æ£€æŸ¥ä»£ç å—æ ¼å¼..."
find . -name "*.md" -exec grep -n "```" {} \; | while read line; do
    file=$(echo "$line" | cut -d: -f1)
    line_num=$(echo "$line" | cut -d: -f2)
    content=$(echo "$line" | cut -d: -f3-)

    # æ£€æŸ¥ä»£ç å—è¯­è¨€æ ‡è¯†
    if [[ "$content" =~ ^```[a-zA-Z]*$ ]]; then
        lang=$(echo "$content" | sed 's/```//')
        if [[ ! "$lang" =~ ^(rust|bash|text|json|yaml|toml)$ ]]; then
            echo "è­¦å‘Š: $file:$line_num æœªçŸ¥çš„ä»£ç å—è¯­è¨€: $lang"
        fi
    fi
done

# æ£€æŸ¥è¡¨æ ¼æ ¼å¼
echo "æ£€æŸ¥è¡¨æ ¼æ ¼å¼..."
find . -name "*.md" -exec grep -n "|" {} \; | while read line; do
    file=$(echo "$line" | cut -d: -f1)
    line_num=$(echo "$line" | cut -d: -f2)
    content=$(echo "$line" | cut -d: -f3-)

    # æ£€æŸ¥è¡¨æ ¼åˆ†éš”ç¬¦
    if [[ "$content" =~ ^\|.*\|$ ]]; then
        if [[ ! "$content" =~ ^\|.*\|.*\|$ ]]; then
            echo "è­¦å‘Š: $file:$line_num è¡¨æ ¼æ ¼å¼å¯èƒ½ä¸æ­£ç¡®: $content"
        fi
    fi
done

echo "æ ¼å¼æ£€æŸ¥å®Œæˆ"
```

### 3. å†…å®¹æ£€æŸ¥å·¥å…·

#### 3.1 æ‹¼å†™æ£€æŸ¥

```bash
# å®‰è£…cspell
npm install -g cspell

# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
cspell README.md

# æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
cspell "**/*.md"

# ä½¿ç”¨é…ç½®æ–‡ä»¶
cspell --config cspell.json "**/*.md"
```

#### 3.2 è‡ªå®šä¹‰å†…å®¹æ£€æŸ¥è„šæœ¬

```bash
#!/bin/bash
# content_checker.sh

echo "å¼€å§‹æ£€æŸ¥æ–‡æ¡£å†…å®¹..."

# æ£€æŸ¥æ–‡æ¡£ç»“æž„
echo "æ£€æŸ¥æ–‡æ¡£ç»“æž„..."
find . -name "*.md" -exec grep -l "^# " {} \; | while read file; do
    # æ£€æŸ¥æ˜¯å¦æœ‰ç›®å½•
    if ! grep -q "^## " "$file"; then
        echo "è­¦å‘Š: $file ç¼ºå°‘äºŒçº§æ ‡é¢˜"
    fi

    # æ£€æŸ¥æ˜¯å¦æœ‰æ¦‚è¿°éƒ¨åˆ†
    if ! grep -q "## ðŸ“‹ æ¦‚è¿°\|## æ¦‚è¿°" "$file"; then
        echo "è­¦å‘Š: $file ç¼ºå°‘æ¦‚è¿°éƒ¨åˆ†"
    fi
done

# æ£€æŸ¥ä»£ç ç¤ºä¾‹
echo "æ£€æŸ¥ä»£ç ç¤ºä¾‹..."
find . -name "*.md" -exec grep -l "```rust" {} \; | while read file; do
    echo "æ£€æŸ¥æ–‡ä»¶: $file"
    # æ£€æŸ¥Rustä»£ç ç¤ºä¾‹æ˜¯å¦æœ‰mainå‡½æ•°
    if grep -q "```rust" "$file" && ! grep -q "fn main" "$file"; then
        echo "è­¦å‘Š: $file åŒ…å«Rustä»£ç ä½†ç¼ºå°‘mainå‡½æ•°"
    fi
done

# æ£€æŸ¥é…ç½®ç¤ºä¾‹
echo "æ£€æŸ¥é…ç½®ç¤ºä¾‹..."
find . -name "*.md" -exec grep -l "```toml\|```yaml\|```json" {} \; | while read file; do
    echo "æ£€æŸ¥æ–‡ä»¶: $file"
    # æ£€æŸ¥é…ç½®ç¤ºä¾‹æ˜¯å¦å®Œæ•´
    if grep -q "```toml" "$file"; then
        if ! grep -q "\[dependencies\]" "$file"; then
            echo "è­¦å‘Š: $file åŒ…å«TOMLé…ç½®ä½†å¯èƒ½ä¸å®Œæ•´"
        fi
    fi
done

echo "å†…å®¹æ£€æŸ¥å®Œæˆ"
```

### 4. è‡ªåŠ¨åŒ–æ£€æŸ¥è„šæœ¬

#### 4.1 å®Œæ•´æ£€æŸ¥è„šæœ¬

```bash
#!/bin/bash
# full_check.sh

echo "å¼€å§‹å®Œæ•´çš„æ–‡æ¡£è´¨é‡æ£€æŸ¥..."

# åˆ›å»ºæ£€æŸ¥ç»“æžœç›®å½•
mkdir -p check_results
timestamp=$(date +"%Y%m%d_%H%M%S")
result_dir="check_results/check_$timestamp"
mkdir -p "$result_dir"

# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
echo "1. æ£€æŸ¥é“¾æŽ¥..."
./link_checker.sh > "$result_dir/link_check.log" 2>&1

echo "2. æ£€æŸ¥æ ¼å¼..."
./format_checker.sh > "$result_dir/format_check.log" 2>&1

echo "3. æ£€æŸ¥å†…å®¹..."
./content_checker.sh > "$result_dir/content_check.log" 2>&1

echo "4. è¿è¡Œmarkdownlint..."
markdownlint "**/*.md" > "$result_dir/markdownlint.log" 2>&1

echo "5. è¿è¡Œæ‹¼å†™æ£€æŸ¥..."
cspell "**/*.md" > "$result_dir/spell_check.log" 2>&1

# ç”Ÿæˆæ£€æŸ¥æŠ¥å‘Š
echo "ç”Ÿæˆæ£€æŸ¥æŠ¥å‘Š..."
cat > "$result_dir/check_report.md" << EOF
# æ–‡æ¡£è´¨é‡æ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¶é—´**: $(date)
**æ£€æŸ¥èŒƒå›´**: æ‰€æœ‰markdownæ–‡æ¡£
**æ£€æŸ¥å·¥å…·**: è‡ªå®šä¹‰è„šæœ¬ + markdownlint + cspell

## æ£€æŸ¥ç»“æžœ

### é“¾æŽ¥æ£€æŸ¥
\`\`\`
$(cat "$result_dir/link_check.log")
\`\`\`

### æ ¼å¼æ£€æŸ¥
\`\`\`
$(cat "$result_dir/format_check.log")
\`\`\`

### å†…å®¹æ£€æŸ¥
\`\`\`
$(cat "$result_dir/content_check.log")
\`\`\`

### Markdownlintæ£€æŸ¥
\`\`\`
$(cat "$result_dir/markdownlint.log")
\`\`\`

### æ‹¼å†™æ£€æŸ¥
\`\`\`
$(cat "$result_dir/spell_check.log")
\`\`\`

## æ€»ç»“

æ£€æŸ¥å®Œæˆï¼Œè¯¦ç»†ç»“æžœè¯·æŸ¥çœ‹å„ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚
EOF

echo "æ£€æŸ¥å®Œæˆï¼Œç»“æžœä¿å­˜åœ¨: $result_dir"
echo "æŸ¥çœ‹æŠ¥å‘Š: cat $result_dir/check_report.md"
```

#### 4.2 CI/CDé›†æˆè„šæœ¬

```yaml
# .github/workflows/docs-check.yml
name: æ–‡æ¡£è´¨é‡æ£€æŸ¥

on:
  push:
    paths:
      - 'otlp/docs/**/*.md'
  pull_request:
    paths:
      - 'otlp/docs/**/*.md'

jobs:
  docs-check:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: è®¾ç½®Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: å®‰è£…æ£€æŸ¥å·¥å…·
      run: |
        npm install -g markdown-link-check
        npm install -g markdownlint-cli
        npm install -g cspell

    - name: è¿è¡Œé“¾æŽ¥æ£€æŸ¥
      run: |
        find otlp/docs -name "*.md" -exec markdown-link-check {} \;

    - name: è¿è¡Œæ ¼å¼æ£€æŸ¥
      run: |
        markdownlint "otlp/docs/**/*.md"

    - name: è¿è¡Œæ‹¼å†™æ£€æŸ¥
      run: |
        cspell "otlp/docs/**/*.md"

    - name: è¿è¡Œè‡ªå®šä¹‰æ£€æŸ¥
      run: |
        chmod +x otlp/docs/quality_check.sh
        ./otlp/docs/quality_check.sh
```

## ðŸ“Š æ£€æŸ¥æ ‡å‡†

### 1. é“¾æŽ¥è´¨é‡æ ‡å‡†

- **å†…éƒ¨é“¾æŽ¥**: æ‰€æœ‰å†…éƒ¨é“¾æŽ¥å¿…é¡»æœ‰æ•ˆ
- **å¤–éƒ¨é“¾æŽ¥**: å¤–éƒ¨é“¾æŽ¥åº”è¯¥å¯è®¿é—®
- **é”šç‚¹é“¾æŽ¥**: é”šç‚¹é“¾æŽ¥å¿…é¡»å‡†ç¡®
- **ç›¸å¯¹è·¯å¾„**: ä½¿ç”¨ç›¸å¯¹è·¯å¾„è€Œéžç»å¯¹è·¯å¾„

### 2. æ ¼å¼è´¨é‡æ ‡å‡†

- **æ ‡é¢˜å±‚çº§**: ä½¿ç”¨æ­£ç¡®çš„æ ‡é¢˜å±‚çº§
- **ä»£ç å—**: ä½¿ç”¨æ­£ç¡®çš„ä»£ç å—æ ¼å¼
- **è¡¨æ ¼æ ¼å¼**: ä½¿ç”¨è§„èŒƒçš„è¡¨æ ¼æ ¼å¼
- **åˆ—è¡¨æ ¼å¼**: ä½¿ç”¨è§„èŒƒçš„åˆ—è¡¨æ ¼å¼

### 3. å†…å®¹è´¨é‡æ ‡å‡†

- **ç»“æž„å®Œæ•´**: æ–‡æ¡£ç»“æž„å®Œæ•´
- **å†…å®¹å‡†ç¡®**: å†…å®¹å‡†ç¡®æ— è¯¯
- **ç¤ºä¾‹å¯è¿è¡Œ**: ä»£ç ç¤ºä¾‹å¯è¿è¡Œ
- **é…ç½®æœ‰æ•ˆ**: é…ç½®ç¤ºä¾‹æœ‰æ•ˆ

### 4. æ‹¼å†™è´¨é‡æ ‡å‡†

- **æ‹¼å†™æ­£ç¡®**: æ‰€æœ‰å•è¯æ‹¼å†™æ­£ç¡®
- **æœ¯è¯­ä¸€è‡´**: æŠ€æœ¯æœ¯è¯­ä½¿ç”¨ä¸€è‡´
- **è¯­æ³•æ­£ç¡®**: è¯­æ³•æ­£ç¡®æ— è¯¯
- **æ ‡ç‚¹è§„èŒƒ**: æ ‡ç‚¹ç¬¦å·ä½¿ç”¨è§„èŒƒ

## ðŸ”§ é…ç½®æ–‡ä»¶

### 1. markdownlinté…ç½®

```json
{
  "default": true,
  "MD013": false,
  "MD033": false,
  "MD041": false,
  "MD024": false,
  "MD029": {
    "style": "ordered"
  }
}
```

### 2. cspellé…ç½®

```json
{
  "version": "0.2",
  "language": "en,zh",
  "words": [
    "OTLP",
    "OpenTelemetry",
    "gRPC",
    "Protobuf",
    "Rust",
    "Tokio",
    "async",
    "await",
    "telemetry",
    "observability",
    "microservices",
    "kubernetes",
    "docker",
    "helm",
    "istio",
    "prometheus",
    "grafana",
    "jaeger",
    "zipkin"
  ],
  "ignoreWords": [
    "config",
    "configs",
    "configurable"
  ],
  "import": [
    "@cspell/dict-rust/cspell-ext.json"
  ]
}
```

## ðŸ“‹ ä½¿ç”¨æŒ‡å—

### 1. æœ¬åœ°æ£€æŸ¥

```bash
# è¿è¡Œå®Œæ•´æ£€æŸ¥
./full_check.sh

# è¿è¡Œå•é¡¹æ£€æŸ¥
./link_checker.sh
./format_checker.sh
./content_checker.sh
```

### 2. æŒç»­é›†æˆ

- åœ¨CI/CDæµæ°´çº¿ä¸­é›†æˆæ£€æŸ¥è„šæœ¬
- è®¾ç½®æ£€æŸ¥å¤±è´¥æ—¶çš„å¤„ç†ç­–ç•¥
- å®šæœŸè¿è¡Œæ£€æŸ¥å¹¶ç”ŸæˆæŠ¥å‘Š

### 3. å›¢é˜Ÿåä½œ

- åœ¨æäº¤å‰è¿è¡Œæ£€æŸ¥
- è®¾ç½®pre-commité’©å­
- å®šæœŸå®¡æŸ¥æ£€æŸ¥ç»“æžœ

## ðŸ“š æ€»ç»“

é€šè¿‡ä½¿ç”¨è¿™äº›è´¨é‡æ£€æŸ¥å·¥å…·ï¼Œå¯ä»¥ç¡®ä¿OTLP Rusté¡¹ç›®æ–‡æ¡£çš„è´¨é‡å’Œä¸€è‡´æ€§ã€‚å»ºè®®ï¼š

1. **å®šæœŸæ£€æŸ¥**: å®šæœŸè¿è¡Œè´¨é‡æ£€æŸ¥
2. **è‡ªåŠ¨åŒ–**: åœ¨CI/CDä¸­é›†æˆæ£€æŸ¥
3. **æŒç»­æ”¹è¿›**: æ ¹æ®æ£€æŸ¥ç»“æžœæŒç»­æ”¹è¿›
4. **å›¢é˜ŸåŸ¹è®­**: åŸ¹è®­å›¢é˜Ÿä½¿ç”¨æ£€æŸ¥å·¥å…·

---

**å·¥å…·ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ27æ—¥
**ç»´æŠ¤è€…**: OTLPæ–‡æ¡£å›¢é˜Ÿ
**ä¸‹æ¬¡æ›´æ–°**: 2025å¹´2æœˆ27æ—¥
