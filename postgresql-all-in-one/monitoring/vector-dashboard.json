{
  "dashboard": {
    "id": null,
    "uid": "vector-monitoring",
    "title": "Vector Data Pipeline Monitoring",
    "tags": ["vector", "data-pipeline", "monitoring"],
    "timezone": "browser",
    "schemaVersion": 38,
    "version": 1,
    "refresh": "10s",
    "panels": [
      {
        "id": 1,
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
        "type": "graph",
        "title": "Events Throughput",
        "targets": [
          {
            "expr": "rate(vector_events_in_total[5m])",
            "legendFormat": "Events In - {{component_name}}",
            "refId": "A"
          },
          {
            "expr": "rate(vector_events_out_total[5m])",
            "legendFormat": "Events Out - {{component_name}}",
            "refId": "B"
          }
        ],
        "yaxes": [
          {"label": "Events/sec", "show": true},
          {"show": true}
        ],
        "xaxis": {"show": true, "mode": "time"},
        "legend": {"show": true, "values": true, "current": true}
      },
      {
        "id": 2,
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
        "type": "graph",
        "title": "Data Volume",
        "targets": [
          {
            "expr": "rate(vector_bytes_in_total[5m])",
            "legendFormat": "Bytes In - {{component_name}}",
            "refId": "A"
          },
          {
            "expr": "rate(vector_bytes_out_total[5m])",
            "legendFormat": "Bytes Out - {{component_name}}",
            "refId": "B"
          }
        ],
        "yaxes": [
          {"label": "Bytes/sec", "show": true, "format": "bytes"},
          {"show": true}
        ],
        "xaxis": {"show": true, "mode": "time"},
        "legend": {"show": true, "values": true, "current": true}
      },
      {
        "id": 3,
        "gridPos": {"h": 8, "w": 8, "x": 0, "y": 8},
        "type": "graph",
        "title": "Processing Latency",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(vector_processing_time_seconds_bucket[5m]))",
            "legendFormat": "P95 - {{component_name}}",
            "refId": "A"
          },
          {
            "expr": "histogram_quantile(0.99, rate(vector_processing_time_seconds_bucket[5m]))",
            "legendFormat": "P99 - {{component_name}}",
            "refId": "B"
          }
        ],
        "yaxes": [
          {"label": "Latency", "show": true, "format": "s"},
          {"show": true}
        ],
        "xaxis": {"show": true, "mode": "time"},
        "alert": {
          "conditions": [
            {
              "evaluator": {"params": [1.0], "type": "gt"},
              "operator": {"type": "and"},
              "query": {"params": ["A", "5m", "now"]},
              "reducer": {"params": [], "type": "avg"},
              "type": "query"
            }
          ],
          "executionErrorState": "alerting",
          "frequency": "60s",
          "handler": 1,
          "name": "High Processing Latency Alert",
          "noDataState": "no_data",
          "notifications": []
        }
      },
      {
        "id": 4,
        "gridPos": {"h": 8, "w": 8, "x": 8, "y": 8},
        "type": "graph",
        "title": "Error Rate",
        "targets": [
          {
            "expr": "rate(vector_errors_total[5m])",
            "legendFormat": "Errors - {{component_name}} - {{error_type}}",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"label": "Errors/sec", "show": true},
          {"show": true}
        ],
        "xaxis": {"show": true, "mode": "time"},
        "legend": {"show": true, "values": true, "current": true},
        "alert": {
          "conditions": [
            {
              "evaluator": {"params": [10.0], "type": "gt"},
              "operator": {"type": "and"},
              "query": {"params": ["A", "5m", "now"]},
              "reducer": {"params": [], "type": "avg"},
              "type": "query"
            }
          ],
          "executionErrorState": "alerting",
          "frequency": "60s",
          "handler": 1,
          "name": "High Error Rate Alert",
          "noDataState": "no_data",
          "notifications": []
        }
      },
      {
        "id": 5,
        "gridPos": {"h": 8, "w": 8, "x": 16, "y": 8},
        "type": "singlestat",
        "title": "Success Rate",
        "targets": [
          {
            "expr": "(sum(rate(vector_events_out_total[5m])) / sum(rate(vector_events_in_total[5m]))) * 100",
            "refId": "A"
          }
        ],
        "valueFontSize": "80%",
        "valueName": "current",
        "format": "percent",
        "thresholds": "80,95",
        "colors": ["#d44a3a", "#e0b400", "#299c46"],
        "gauge": {
          "show": true,
          "minValue": 0,
          "maxValue": 100,
          "thresholdMarkers": true
        }
      },
      {
        "id": 6,
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16},
        "type": "graph",
        "title": "Buffer Usage",
        "targets": [
          {
            "expr": "vector_buffer_events",
            "legendFormat": "Buffered Events - {{component_name}}",
            "refId": "A"
          },
          {
            "expr": "vector_buffer_bytes",
            "legendFormat": "Buffered Bytes - {{component_name}}",
            "refId": "B"
          }
        ],
        "yaxes": [
          {"label": "Count", "show": true},
          {"show": true}
        ],
        "xaxis": {"show": true, "mode": "time"},
        "legend": {"show": true, "values": true, "current": true}
      },
      {
        "id": 7,
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 16},
        "type": "graph",
        "title": "Component Memory Usage",
        "targets": [
          {
            "expr": "vector_memory_used_bytes",
            "legendFormat": "Memory - {{component_name}}",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"label": "Bytes", "show": true, "format": "bytes"},
          {"show": true}
        ],
        "xaxis": {"show": true, "mode": "time"},
        "legend": {"show": true, "values": true, "current": true}
      },
      {
        "id": 8,
        "gridPos": {"h": 8, "w": 24, "x": 0, "y": 24},
        "type": "table",
        "title": "Component Status",
        "targets": [
          {
            "expr": "vector_component_received_events_total",
            "instant": true,
            "legendFormat": "",
            "refId": "A"
          }
        ],
        "transformations": [
          {
            "id": "organize",
            "options": {
              "excludeByName": {},
              "indexByName": {},
              "renameByName": {
                "component_name": "Component",
                "component_type": "Type",
                "Value": "Events Received"
              }
            }
          }
        ]
      }
    ],
    "templating": {
      "list": [
        {
          "name": "namespace",
          "type": "query",
          "query": "label_values(vector_events_in_total, namespace)",
          "refresh": 1,
          "includeAll": false
        },
        {
          "name": "pod",
          "type": "query",
          "query": "label_values(vector_events_in_total{namespace=\"$namespace\"}, pod)",
          "refresh": 1,
          "includeAll": true
        }
      ]
    },
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "timepicker": {
      "refresh_intervals": ["5s", "10s", "30s", "1m", "5m", "15m", "30m", "1h"],
      "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "2d", "7d", "30d"]
    }
  }
}

