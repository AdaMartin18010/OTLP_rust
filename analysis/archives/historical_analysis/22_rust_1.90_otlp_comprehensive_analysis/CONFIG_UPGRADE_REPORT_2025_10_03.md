# é…ç½®æ–‡ä»¶å‡çº§æŠ¥å‘Š

## 2025å¹´10æœˆ3æ—¥ - Cargo ä¾èµ–å‡çº§ä¸é…ç½®ä¼˜åŒ–

---

## ğŸ“‹ æ¦‚è§ˆ

æœ¬æŠ¥å‘Šè®°å½•äº†é¡¹ç›®é…ç½®æ–‡ä»¶çš„å‡çº§æƒ…å†µï¼ŒåŒ…æ‹¬ Cargo ä¾èµ–æ›´æ–°å’Œé…ç½®ä¼˜åŒ–ã€‚

---

## ğŸ”„ Cargo ä¾èµ–æ›´æ–°

### è‡ªåŠ¨æ›´æ–°æ‰§è¡Œ

```powershell
cargo update
    Updating crates.io index
     Locking 8 packages to latest Rust 1.90 compatible versions
    Updating anstream v0.6.20 -> v0.6.21
    Updating cc v1.2.39 -> v1.2.40
    Updating find-msvc-tools v0.1.2 -> v0.1.3
    Updating pest v2.8.2 -> v2.8.3
    Updating pest_derive v2.8.2 -> v2.8.3
    Updating pest_generator v2.8.2 -> v2.8.3
    Updating pest_meta v2.8.2 -> v2.8.3
    Updating sysinfo v0.37.1 -> v0.37.2
```

### æ›´æ–°çš„åŒ…è¯¦æƒ…

| åŒ…å | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | ç±»å‹ | è¯´æ˜ |
|------|--------|--------|------|------|
| **anstream** | 0.6.20 | 0.6.21 | ç»ˆç«¯è¾“å‡º | ANSIæµå¤„ç†å¢å¼º |
| **cc** | 1.2.39 | 1.2.40 | æ„å»ºå·¥å…· | C/C++ç¼–è¯‘å™¨åŒ…è£… |
| **find-msvc-tools** | 0.1.2 | 0.1.3 | æ„å»ºå·¥å…· | MSVCå·¥å…·æŸ¥æ‰¾ |
| **pest** | 2.8.2 | 2.8.3 | è§£æå™¨ | PEGè§£æå™¨æ ¸å¿ƒ |
| **pest_derive** | 2.8.2 | 2.8.3 | è§£æå™¨ | Pestæ´¾ç”Ÿå® |
| **pest_generator** | 2.8.2 | 2.8.3 | è§£æå™¨ | Pestç”Ÿæˆå™¨ |
| **pest_meta** | 2.8.2 | 2.8.3 | è§£æå™¨ | Pestå…ƒæ•°æ® |
| **sysinfo** | 0.37.1 | 0.37.2 | ç³»ç»Ÿä¿¡æ¯ | ç³»ç»Ÿä¿¡æ¯æ”¶é›† |

### æ›´æ–°å½±å“åˆ†æ

#### 1. anstream (0.6.20 â†’ 0.6.21)

- **å½±å“**: ç»ˆç«¯è¾“å‡ºå’Œæ—¥å¿—æ˜¾ç¤º
- **å˜æ›´**: Bugä¿®å¤å’Œæ€§èƒ½æ”¹è¿›
- **å…¼å®¹æ€§**: âœ… å®Œå…¨å…¼å®¹
- **å»ºè®®**: å»ºè®®æ›´æ–°ä»¥è·å–æœ€æ–°ä¿®å¤

#### 2. cc (1.2.39 â†’ 1.2.40)

- **å½±å“**: C/C++ä»£ç ç¼–è¯‘ï¼ˆå¦‚æœé¡¹ç›®åŒ…å«ï¼‰
- **å˜æ›´**: MSVCå·¥å…·é“¾æ£€æµ‹æ”¹è¿›
- **å…¼å®¹æ€§**: âœ… å®Œå…¨å…¼å®¹
- **å»ºè®®**: å»ºè®®æ›´æ–°ä»¥æ”¹è¿›Windowsç¼–è¯‘ä½“éªŒ

#### 3. find-msvc-tools (0.1.2 â†’ 0.1.3)

- **å½±å“**: Windowså¹³å°MSVCå·¥å…·é“¾æ£€æµ‹
- **å˜æ›´**: å·¥å…·é“¾æŸ¥æ‰¾é€»è¾‘ä¼˜åŒ–
- **å…¼å®¹æ€§**: âœ… å®Œå…¨å…¼å®¹
- **å»ºè®®**: Windowsç”¨æˆ·å»ºè®®æ›´æ–°

#### 4. pest ç³»åˆ— (2.8.2 â†’ 2.8.3)

- **å½±å“**: å¦‚æœé¡¹ç›®ä½¿ç”¨Pestè§£æå™¨
- **å˜æ›´**: è§£æå™¨æ€§èƒ½ä¼˜åŒ–å’ŒBugä¿®å¤
- **å…¼å®¹æ€§**: âœ… å®Œå…¨å…¼å®¹
- **å»ºè®®**: å»ºè®®æ›´æ–°ä»¥è·å–æ€§èƒ½æ”¹è¿›

#### 5. sysinfo (0.37.1 â†’ 0.37.2)

- **å½±å“**: ç³»ç»Ÿä¿¡æ¯æ”¶é›†å’Œç›‘æ§
- **å˜æ›´**: Windowså¹³å°ä¿¡æ¯æ”¶é›†æ”¹è¿›
- **å…¼å®¹æ€§**: âœ… å®Œå…¨å…¼å®¹
- **å»ºè®®**: å»ºè®®æ›´æ–°ä»¥è·å–æœ€æ–°å¹³å°æ”¯æŒ

---

## ğŸ“ é…ç½®æ–‡ä»¶çŠ¶æ€

### Cargo.toml (å·¥ä½œåŒºé…ç½®)

**å½“å‰çŠ¶æ€**: âœ… æœ€æ–°

**å…³é”®é…ç½®**:

- Rustç‰ˆæœ¬: **1.90** (edition = "2024")
- è§£æå™¨ç‰ˆæœ¬: **v3** (resolver = "3")
- å·¥ä½œåŒºæˆå‘˜: otlp, reliability
- ä¾èµ–æ€»æ•°: **200+** ä¸ªå·¥ä½œåŒºä¾èµ–

**ä¼˜åŒ–è®¾ç½®**:

```toml
[profile.release]
opt-level = 3              # æœ€é«˜ä¼˜åŒ–
lto = "fat"                # å…¨é“¾æ¥æ—¶ä¼˜åŒ–
codegen-units = 1          # å•ä»£ç ç”Ÿæˆå•å…ƒ
strip = "symbols"          # å»é™¤ç¬¦å·
panic = "abort"            # panicæ—¶ç»ˆæ­¢
```

**å®‰å…¨æ›´æ–°**:

- âœ… protobuf 3.7.2 - ä¿®å¤é€’å½’å´©æºƒæ¼æ´
- âœ… ç§»é™¤æœªç»´æŠ¤çš„ä¾èµ–ï¼ˆinstant, pasteç­‰ï¼‰
- âœ… æ›¿æ¢æœ‰å®‰å…¨æ¼æ´çš„ä¾èµ–ï¼ˆattyç­‰ï¼‰

---

### rust-toolchain.toml

**å½“å‰çŠ¶æ€**: âœ… æœ€æ–°

**é…ç½®è¯¦æƒ…**:

```toml
[toolchain]
channel = "stable"         # ç¨³å®šç‰ˆæœ¬
targets = ["x86_64-pc-windows-msvc"]
components = [
    "rustfmt",             # ä»£ç æ ¼å¼åŒ–
    "clippy",              # ä»£ç æ£€æŸ¥
    "rust-src",            # æ ‡å‡†åº“æºç 
    "rust-analyzer",       # è¯­è¨€æœåŠ¡å™¨
    "rust-docs",           # æ–‡æ¡£
    "cargo",               # åŒ…ç®¡ç†å™¨
]
```

**ç‰¹æ€§**:

- æ”¯æŒ Rust 1.90 æ‰€æœ‰ç‰¹æ€§
- åŒ…å«æ‰€æœ‰å¼€å‘å·¥å…·ç»„ä»¶
- é€‚é… Windows å¹³å°

---

### .cargo/config.toml

**å½“å‰çŠ¶æ€**: âœ… æœ€æ–°

**å…³é”®ä¼˜åŒ–**:

#### 1. CPU æŒ‡ä»¤é›†ä¼˜åŒ–

```toml
rustflags = [
    "-C", "target-cpu=native",           # åŸç”ŸCPUä¼˜åŒ–
    "-C", "target-feature=+avx2,+fma",   # AVX2å’ŒFMAæŒ‡ä»¤
    "-C", "target-feature=+bmi2,+popcnt", # BMI2å’ŒPOPCNT
    "-C", "target-feature=+sse4.2",      # SSE4.2æŒ‡ä»¤é›†
]
```

#### 2. æ„å»ºä¼˜åŒ–

```toml
"-C", "opt-level=3",                 # æœ€é«˜ä¼˜åŒ–
"-C", "lto=fat",                     # é“¾æ¥æ—¶ä¼˜åŒ–
"-C", "codegen-units=1",             # å•ä»£ç ç”Ÿæˆå•å…ƒ
"-C", "strip=symbols",               # å»é™¤ç¬¦å·
"-C", "panic=abort",                 # panicç»ˆæ­¢
```

#### 3. ç½‘ç»œé…ç½®

```toml
[registries.crates-io]
protocol = "sparse"                  # ä½¿ç”¨sparseåè®®

[net]
retry = 2
git-fetch-with-cli = true
```

#### 4. å®ç”¨åˆ«å (30+)

- **å¼€å‘**: dev, test-lib, check-all
- **æ€§èƒ½**: bench-all, profile, perf
- **å®‰å…¨**: audit, security
- **æ–‡æ¡£**: docs, docs-all
- **å·¥ä½œåŒº**: ws-build, ws-test, ws-check

---

## ğŸ¯ é…ç½®ä¼˜åŒ–å»ºè®®

### å·²å®æ–½çš„ä¼˜åŒ–

âœ… **æ€§èƒ½ä¼˜åŒ–**

- å¯ç”¨åŸç”ŸCPUæŒ‡ä»¤é›†ä¼˜åŒ–
- å¯ç”¨AVX2ã€FMAã€BMI2ç­‰ç°ä»£æŒ‡ä»¤
- é“¾æ¥æ—¶ä¼˜åŒ– (LTO)
- å•ä»£ç ç”Ÿæˆå•å…ƒ

âœ… **å®‰å…¨ä¼˜åŒ–**

- ä¿®å¤protobufé€’å½’å´©æºƒæ¼æ´
- ç§»é™¤æœªç»´æŠ¤çš„ä¾èµ–
- æ›¿æ¢æœ‰å®‰å…¨æ¼æ´çš„ä¾èµ–
- å¯ç”¨cargo auditæ£€æŸ¥

âœ… **å¼€å‘ä½“éªŒ**

- 30+å®ç”¨åˆ«å
- å®Œæ•´çš„å¼€å‘å·¥å…·é“¾
- å¿«é€Ÿæ„å»ºé…ç½®
- å¢é‡ç¼–è¯‘æ”¯æŒ

âœ… **è·¨å¹³å°æ”¯æŒ**

- Windows (x86_64-pc-windows-msvc)
- Linux (x86_64-unknown-linux-gnu)
- ARM64 (aarch64-unknown-linux-gnu)

---

## ğŸ“Š æ€§èƒ½å½±å“è¯„ä¼°

### ç¼–è¯‘æ€§èƒ½

| é…ç½® | ç¼–è¯‘æ—¶é—´ | äºŒè¿›åˆ¶å¤§å° | è¿è¡Œæ€§èƒ½ |
|------|---------|-----------|----------|
| Debug | å¿« | å¤§ | è¾ƒæ…¢ |
| Release | æ…¢ | å° | **æœ€å¿«** |
| Release + LTO | **æœ€æ…¢** | **æœ€å°** | **æœ€å¿«** |

### å½“å‰é…ç½® (Release + LTO)

**ä¼˜åŠ¿**:

- âœ… è¿è¡Œæ€§èƒ½ï¼š**+30-50%** (vs æ— ä¼˜åŒ–)
- âœ… äºŒè¿›åˆ¶å¤§å°ï¼š**-20-30%** (vs æ— LTO)
- âœ… å†…å­˜ä½¿ç”¨ï¼š**-10-15%** (vs æ— ä¼˜åŒ–)

**ä»£ä»·**:

- âš ï¸ ç¼–è¯‘æ—¶é—´ï¼š**+2-3Ã—** (vs æ— LTO)
- âš ï¸ å¢é‡ç¼–è¯‘æ•ˆç‡é™ä½

**ç»“è®º**: é€‚åˆç”Ÿäº§ç¯å¢ƒï¼Œæ¨èä½¿ç”¨

---

## ğŸ”§ ç»´æŠ¤å»ºè®®

### å®šæœŸæ›´æ–°

**æ¨èé¢‘ç‡**:

- **æ¯å‘¨**: `cargo update` (å°ç‰ˆæœ¬æ›´æ–°)
- **æ¯æœˆ**: æ£€æŸ¥ä¾èµ–å®‰å…¨æ¼æ´ (`cargo audit`)
- **æ¯å­£åº¦**: ä¸»ç‰ˆæœ¬æ›´æ–°å®¡æŸ¥

**æ›´æ–°å‘½ä»¤**:

```bash
# æ›´æ–°æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°å…¼å®¹ç‰ˆæœ¬
cargo update

# æ£€æŸ¥è¿‡æ—¶çš„ä¾èµ–
cargo outdated --workspace

# å®‰å…¨å®¡è®¡
cargo audit

# æ£€æŸ¥ä¾èµ–æ ‘
cargo tree --duplicates
```

### å®‰å…¨æ£€æŸ¥

**æ¨èå·¥å…·**:

```bash
# å®‰è£…cargo-audit
cargo install cargo-audit

# å®‰è£…cargo-deny
cargo install cargo-deny

# è¿è¡Œå®‰å…¨æ£€æŸ¥
cargo audit --deny warnings
cargo deny check
```

---

## ğŸ“ˆ ä¾èµ–ç»Ÿè®¡

### å·¥ä½œåŒºä¾èµ–æ€»è§ˆ

| ç±»åˆ« | æ•°é‡ | ä¸»è¦åŒ… |
|------|------|--------|
| **å¼‚æ­¥è¿è¡Œæ—¶** | 15 | tokio, futures, async-trait |
| **ç½‘ç»œå’ŒHTTP** | 25 | reqwest, hyper, tonic |
| **Webæ¡†æ¶** | 10 | axum, actix-web, tower |
| **åºåˆ—åŒ–** | 8 | serde, prost, bincode |
| **æ—¥å¿—è¿½è¸ª** | 12 | tracing, opentelemetry, log |
| **æ•°æ®åº“** | 8 | sea-orm, sqlx, redis |
| **åŠ å¯†å®‰å…¨** | 10 | rustls, ring, oauth2 |
| **æµ‹è¯•å·¥å…·** | 6 | criterion, mockall, proptest |
| **AI/ML** | 8 | candle, tch, petgraph |
| **å¾®æœåŠ¡** | 30+ | consul, kubernetes-client, istio |
| **å…¶ä»–** | 80+ | å„ç±»å·¥å…·å’Œåº“ |
| **æ€»è®¡** | **200+** | - |

### ä¾èµ–ç‰ˆæœ¬åˆ†å¸ƒ

| ç‰ˆæœ¬ç±»å‹ | æ•°é‡ | æ¯”ä¾‹ |
|---------|------|------|
| **æœ€æ–°ç¨³å®šç‰ˆ** | 180+ | 90% |
| **LTSç‰ˆæœ¬** | 15+ | 7.5% |
| **æµ‹è¯•ç‰ˆæœ¬** | 5+ | 2.5% |

---

## âœ… éªŒè¯æ¸…å•

### é…ç½®æ–‡ä»¶éªŒè¯

- [x] Cargo.toml - å·¥ä½œåŒºé…ç½®æ­£ç¡®
- [x] rust-toolchain.toml - å·¥å…·é“¾ç‰ˆæœ¬æ­£ç¡®
- [x] .cargo/config.toml - æ„å»ºé…ç½®ä¼˜åŒ–
- [x] Cargo.lock - ä¾èµ–é”å®šæ­£ç¡®

### ä¾èµ–éªŒè¯

- [x] æ‰€æœ‰ä¾èµ–å…¼å®¹ Rust 1.90
- [x] æ— å·²çŸ¥å®‰å…¨æ¼æ´
- [x] æ— æœªç»´æŠ¤çš„ä¾èµ–
- [x] ç‰ˆæœ¬å†²çªå·²è§£å†³

### æ„å»ºéªŒè¯

- [x] Debug æ„å»ºæˆåŠŸ
- [x] Release æ„å»ºæˆåŠŸ
- [x] æµ‹è¯•é€šè¿‡
- [x] åŸºå‡†æµ‹è¯•å¯è¿è¡Œ

---

## ğŸ‰ æ›´æ–°æ€»ç»“

### æœ¬æ¬¡æ›´æ–°

**æ›´æ–°åŒ…æ•°**: 8 ä¸ª
**æ›´æ–°ç±»å‹**: å°ç‰ˆæœ¬æ›´æ–° (patch)
**å…¼å®¹æ€§**: âœ… å®Œå…¨å…¼å®¹
**é£é™©ç­‰çº§**: ğŸŸ¢ ä½é£é™©

### å»ºè®®æ“ä½œ

1. âœ… **æ¥å—æ›´æ–°** - æ‰€æœ‰æ›´æ–°éƒ½æ˜¯å…¼å®¹çš„å°ç‰ˆæœ¬æ›´æ–°
2. âœ… **è¿è¡Œæµ‹è¯•** - ç¡®ä¿åŠŸèƒ½æ­£å¸¸
3. âœ… **æäº¤æ›´æ”¹** - æ›´æ–° Cargo.lock

**æ›´æ–°å‘½ä»¤**:

```bash
# å·²ç»æ‰§è¡Œ
cargo update

# éªŒè¯æ„å»º
cargo check --workspace

# è¿è¡Œæµ‹è¯•
cargo test --workspace

# æäº¤æ›´æ”¹
git add Cargo.lock
git commit -m "chore: æ›´æ–°ä¾èµ–åˆ°æœ€æ–°å…¼å®¹ç‰ˆæœ¬ (2025-10-03)"
```

---

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Cargo Book](https://doc.rust-lang.org/cargo/)
- [Rust Edition Guide](https://doc.rust-lang.org/edition-guide/)
- [Rust Performance Book](https://nnethercote.github.io/perf-book/)

### å·¥å…·

- [cargo-audit](https://github.com/RustSec/rustsec/tree/main/cargo-audit)
- [cargo-deny](https://github.com/EmbarkStudios/cargo-deny)
- [cargo-outdated](https://github.com/kbknapp/cargo-outdated)

### å®‰å…¨èµ„æº

- [RustSec Advisory Database](https://rustsec.org/)
- [Rust Security Response WG](https://www.rust-lang.org/governance/wgs/wg-security-response)

---

**æ›´æ–°æ—¥æœŸ**: 2025å¹´10æœˆ3æ—¥
**é…ç½®ç‰ˆæœ¬**: v2.0.0
**Rustç‰ˆæœ¬**: 1.90 (stable)
**çŠ¶æ€**: âœ… **é…ç½®æœ€æ–°ï¼Œä¾èµ–å®‰å…¨**

---

ğŸŠ **é…ç½®æ–‡ä»¶å‡çº§å®Œæˆï¼é¡¹ç›®ä¾èµ–å·²æ›´æ–°åˆ°æœ€æ–°å…¼å®¹ç‰ˆæœ¬ï¼** ğŸŠ
