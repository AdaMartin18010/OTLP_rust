# OpenTelemetry OTLP 综合快速参考手册

> **最后更新**: 2025年10月8日  
> **适用版本**: OpenTelemetry v1.27.0+  
> **阅读时间**: 5-10分钟  
> **用途**: 快速查找常用信息、配置和解决方案

---

## 📋 目录

- [OpenTelemetry OTLP 综合快速参考手册](#opentelemetry-otlp-综合快速参考手册)
  - [📋 目录](#-目录)
  - [一页纸速查表](#一页纸速查表)
    - [OTLP 核心信息](#otlp-核心信息)
  - [核心端点与配置](#核心端点与配置)
    - [OTLP gRPC 端点](#otlp-grpc-端点)
    - [OTLP HTTP 端点](#otlp-http-端点)
    - [常用后端端点](#常用后端端点)
  - [环境变量速查](#环境变量速查)
    - [通用配置](#通用配置)
    - [OTLP 导出器配置](#otlp-导出器配置)
    - [采样配置](#采样配置)
    - [传播器配置](#传播器配置)
    - [批处理配置](#批处理配置)
  - [决策矩阵](#决策矩阵)
    - [1. 传输协议选择矩阵](#1-传输协议选择矩阵)
    - [2. 采样策略选择矩阵](#2-采样策略选择矩阵)
    - [3. Collector部署模式选择](#3-collector部署模式选择)
    - [4. 数据存储后端选择](#4-数据存储后端选择)
  - [性能参考](#性能参考)
    - [各组件性能基准](#各组件性能基准)
      - [SDK 性能影响](#sdk-性能影响)
      - [Collector 性能基准](#collector-性能基准)
    - [资源消耗参考](#资源消耗参考)
      - [按流量规模估算](#按流量规模估算)
      - [带宽消耗估算](#带宽消耗估算)
    - [优化建议检查清单](#优化建议检查清单)
  - [配置模板速查](#配置模板速查)
    - [最小化配置](#最小化配置)
    - [标准生产配置](#标准生产配置)
    - [高可用配置](#高可用配置)
  - [常用命令集合](#常用命令集合)
    - [Docker运行Collector](#docker运行collector)
    - [Kubernetes部署](#kubernetes部署)
    - [测试与验证](#测试与验证)
    - [日志与调试](#日志与调试)
  - [故障排查速查](#故障排查速查)
    - [快速诊断命令](#快速诊断命令)
    - [常见问题速查表](#常见问题速查表)
    - [关键指标监控](#关键指标监控)
  - [参考文档快速索引](#参考文档快速索引)
    - [按主题分类](#按主题分类)
  - [贡献与反馈](#贡献与反馈)

---

## 一页纸速查表

### OTLP 核心信息

```text
┌─────────────────────────────────────────────────────────────┐
│              OpenTelemetry OTLP 速查表                       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│ 📡 默认端点:                                                  │
│   gRPC: localhost:4317                                        │
│   HTTP: localhost:4318                                        │
│                                                               │
│ 🔗 路径:                                                      │
│   Traces: /v1/traces                                          │
│   Metrics: /v1/metrics                                        │
│   Logs: /v1/logs                                              │
│                                                               │
│ 🔑 环境变量前缀:                                              │
│   OTEL_*  (通用配置)                                          │
│   OTEL_EXPORTER_OTLP_* (导出器配置)                          │
│                                                               │
│ 📦 传输协议:                                                  │
│   - gRPC (推荐生产环境)                                       │
│   - HTTP/Protobuf (兼容性好)                                 │
│   - HTTP/JSON (调试友好)                                     │
│                                                               │
│ ⚡ 性能对比 (p50延迟):                                        │
│   gRPC:  3ms | HTTP/Protobuf: 5ms | HTTP/JSON: 8ms          │
│                                                               │
│ 🛡️ 认证方式:                                                 │
│   - TLS/mTLS (推荐)                                           │
│   - Bearer Token                                              │
│   - Basic Auth                                                │
│                                                               │
│ 💾 数据格式:                                                  │
│   - Protocol Buffers (默认，推荐)                            │
│   - JSON (调试用)                                             │
│                                                               │
│ 🎯 采样策略:                                                  │
│   - AlwaysOn (开发)                                           │
│   - ParentBased (推荐)                                        │
│   - TraceIdRatioBased (生产)                                  │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

---

## 核心端点与配置

### OTLP gRPC 端点

```yaml
# 默认配置
endpoint: localhost:4317
protocol: grpc
compression: gzip
timeout: 10s
```

**服务定义**:

```protobuf
service:
  TraceService:    /opentelemetry.proto.collector.trace.v1.TraceService
  MetricsService:  /opentelemetry.proto.collector.metrics.v1.MetricsService  
  LogsService:     /opentelemetry.proto.collector.logs.v1.LogsService
```

### OTLP HTTP 端点

```yaml
# 默认配置
endpoint: http://localhost:4318
protocol: http/protobuf
headers:
  Content-Type: application/x-protobuf
```

**路径规范**:

```text
Traces:  POST http://localhost:4318/v1/traces
Metrics: POST http://localhost:4318/v1/metrics
Logs:    POST http://localhost:4318/v1/logs
```

### 常用后端端点

| 后端 | gRPC 端点 | HTTP 端点 |
|------|-----------|-----------|
| **Jaeger** | localhost:4317 | <http://localhost:4318> |
| **Grafana Tempo** | tempo:4317 | <http://tempo:4318> |
| **AWS X-Ray** | (通过Collector) | <https://xray.region.amazonaws.com> |
| **Azure Monitor** | (通过Collector) | <https://dc.services.visualstudio.com> |
| **Google Cloud Trace** | (通过Collector) | <https://cloudtrace.googleapis.com> |
| **Elastic APM** | localhost:8200 | <http://localhost:8200> |

---

## 环境变量速查

### 通用配置

```bash
# 服务标识
OTEL_SERVICE_NAME=my-service
OTEL_SERVICE_VERSION=1.0.0
OTEL_DEPLOYMENT_ENVIRONMENT=production

# 资源属性
OTEL_RESOURCE_ATTRIBUTES="service.name=my-service,service.version=1.0.0"

# SDK配置
OTEL_SDK_DISABLED=false
OTEL_LOG_LEVEL=info
```

### OTLP 导出器配置

```bash
# 端点配置
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf    # grpc | http/protobuf | http/json

# 按信号配置（可覆盖通用配置）
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:4318/v1/traces
OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=http://localhost:4318/v1/metrics
OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=http://localhost:4318/v1/logs

# 超时配置
OTEL_EXPORTER_OTLP_TIMEOUT=10000            # 毫秒

# 头部配置
OTEL_EXPORTER_OTLP_HEADERS="api-key=secret,x-tenant=acme"

# TLS配置
OTEL_EXPORTER_OTLP_CERTIFICATE=/path/to/cert.pem
OTEL_EXPORTER_OTLP_CLIENT_KEY=/path/to/key.pem
OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE=/path/to/client.pem

# 压缩
OTEL_EXPORTER_OTLP_COMPRESSION=gzip         # none | gzip
```

### 采样配置

```bash
# 采样器类型
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1    # 10% 采样率
```

**采样器选项**:

- `always_on` - 采样所有trace
- `always_off` - 不采样
- `traceidratio` - 基于TraceID的比例采样
- `parentbased_always_on` - 父级采样则采样
- `parentbased_traceidratio` - 父级采样，否则按比例

### 传播器配置

```bash
OTEL_PROPAGATORS=tracecontext,baggage,b3
```

**传播器选项**:

- `tracecontext` - W3C Trace Context (推荐)
- `baggage` - W3C Baggage
- `b3` - Zipkin B3 (单头)
- `b3multi` - Zipkin B3 (多头)
- `jaeger` - Jaeger传播
- `xray` - AWS X-Ray传播

### 批处理配置

```bash
# BatchSpanProcessor配置
OTEL_BSP_SCHEDULE_DELAY=5000                # 导出延迟(ms)
OTEL_BSP_EXPORT_TIMEOUT=30000               # 导出超时(ms)
OTEL_BSP_MAX_QUEUE_SIZE=2048                # 队列大小
OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512          # 批次大小

# BatchMetricReader配置  
OTEL_BMR_SCHEDULE_DELAY=60000               # 导出间隔(ms)
OTEL_BMR_EXPORT_TIMEOUT=30000               # 导出超时(ms)
```

---

## 决策矩阵

### 1. 传输协议选择矩阵

| 场景 | 推荐协议 | 理由 |
|------|---------|------|
| **生产环境** | gRPC | 性能最佳，延迟低，支持双向流 |
| **云环境** | gRPC | 原生支持负载均衡 |
| **防火墙限制** | HTTP | 仅允许HTTP/HTTPS |
| **调试开发** | HTTP/JSON | 人类可读，易于调试 |
| **跨语言集成** | HTTP/Protobuf | 兼容性最好 |
| **高吞吐场景** | gRPC | 吞吐量高50% |
| **Serverless** | HTTP | 冷启动快，无需长连接 |

**性能对比**:

```text
指标              | gRPC  | HTTP/Protobuf | HTTP/JSON
------------------|-------|---------------|----------
p50 延迟          | 3ms   | 5ms           | 8ms
p99 延迟          | 15ms  | 22ms          | 35ms
吞吐量            | 25k/s | 15k/s         | 8k/s
带宽占用          | 1KB   | 1.2KB         | 2.5KB
CPU占用           | 低    | 中            | 高
```

### 2. 采样策略选择矩阵

| 流量规模 | Head-based采样 | Tail-based采样 | 采样率建议 |
|---------|---------------|---------------|----------|
| **< 10 QPS** | AlwaysOn | 不需要 | 100% |
| **10-100 QPS** | ParentBased + TraceIdRatio | 可选 | 10-100% |
| **100-1K QPS** | ParentBased + TraceIdRatio | 推荐 | 1-10% |
| **> 1K QPS** | ParentBased + TraceIdRatio | 必须 | 0.1-1% |
| **高价值流量** | Custom Sampler | Tail-based | 按规则 |

**采样策略组合建议**:

```yaml
# 低流量开发环境
sampler: always_on

# 中等流量测试环境  
sampler: parentbased_traceidratio
arg: 0.1  # 10%

# 高流量生产环境
sampler: parentbased_traceidratio
arg: 0.01  # 1%

# 高价值trace保证采样
sampler: composite
  - rule: http.status_code >= 400  # 错误全采样
    rate: 1.0
  - rule: http.route == "/api/payment"  # 关键路径全采样
    rate: 1.0
  - default: 0.01  # 其他1%
```

### 3. Collector部署模式选择

| 场景 | 部署模式 | 组件 | 优势 |
|------|---------|------|------|
| **单体应用** | No Collector | SDK → Backend | 简单，延迟最低 |
| **小规模微服务** | Agent模式 | SDK → Agent → Backend | 应用解耦 |
| **中等规模** | Gateway模式 | SDK → Gateway集群 → Backend | 集中管理 |
| **大规模生产** | 混合模式 | SDK → Agent → Gateway → Backend | 最佳实践 |
| **多租户** | Gateway模式 | SDK → Gateway → 多Backend | 租户隔离 |
| **边缘计算** | Agent模式 | SDK → 边缘Agent → 中心Backend | 本地聚合 |

**部署模式对比**:

```text
模式          | 复杂度 | 可靠性 | 性能   | 成本   | 推荐场景
--------------|--------|--------|--------|--------|----------
无Collector   | 低     | 中     | 最高   | 最低   | 开发/原型
Agent         | 中     | 高     | 高     | 中     | 生产推荐
Gateway       | 中     | 高     | 中     | 中     | 集中管理
混合(推荐)    | 高     | 最高   | 高     | 高     | 大规模生产
```

### 4. 数据存储后端选择

| 后端 | 最适场景 | Traces | Metrics | Logs | 成本 |
|------|---------|--------|---------|------|------|
| **Jaeger** | 追踪分析 | ⭐⭐⭐⭐⭐ | ❌ | ❌ | 低 |
| **Tempo** | 追踪存储 | ⭐⭐⭐⭐⭐ | ❌ | ❌ | 低 |
| **Prometheus** | 指标监控 | ❌ | ⭐⭐⭐⭐⭐ | ❌ | 低 |
| **Loki** | 日志聚合 | ❌ | ❌ | ⭐⭐⭐⭐⭐ | 低 |
| **Elastic Stack** | 全栈可观测性 | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 中 |
| **Datadog** | 商业SaaS | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 高 |
| **AWS X-Ray** | AWS生态 | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 中 |
| **Azure Monitor** | Azure生态 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 中 |
| **Google Cloud** | GCP生态 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 中 |

**推荐组合**:

```text
开源免费组合:
  Traces: Jaeger/Tempo
  Metrics: Prometheus
  Logs: Loki
  可视化: Grafana

云原生组合:
  AWS: X-Ray + CloudWatch
  Azure: Application Insights
  GCP: Cloud Trace + Cloud Monitoring

商业SaaS:
  全能: Datadog / New Relic / Dynatrace
```

---

## 性能参考

### 各组件性能基准

#### SDK 性能影响

```text
组件              | CPU影响 | 内存影响 | 延迟增加
------------------|---------|---------|----------
TracerProvider    | < 1%    | 10-50MB | < 0.1ms
SpanProcessor     | 1-3%    | 20-100MB| 0.1-0.5ms
OTLP Exporter     | 2-5%    | 50-200MB| 0.5-2ms
采样器            | < 0.5%  | < 10MB  | < 0.05ms
总计(典型)        | 3-8%    | 80-350MB| 0.7-2.5ms
```

#### Collector 性能基准

**硬件配置**: 4 CPU / 8GB RAM

```text
配置              | 吞吐量        | CPU使用 | 内存使用
------------------|--------------|---------|----------
基础配置          | 10K spans/s  | 40%     | 500MB
生产配置          | 50K spans/s  | 80%     | 2GB
优化配置          | 100K spans/s | 85%     | 4GB
```

**单组件性能**:

```text
组件              | 吞吐量上限    | CPU占用 | 延迟
------------------|--------------|---------|-------
OTLP Receiver     | 200K spans/s | 低      | < 1ms
Batch Processor   | 500K spans/s | 低      | < 5ms
Attributes Proc   | 100K spans/s | 中      | < 2ms
Tail Sampling     | 50K spans/s  | 高      | 10-100ms
OTLP Exporter     | 150K spans/s | 中      | 5-20ms
```

### 资源消耗参考

#### 按流量规模估算

| QPS | Spans/秒 | SDK内存 | Collector配置 | 存储(天) |
|-----|---------|---------|--------------|----------|
| 10 | 100 | 50MB | 1C/512MB | 10MB |
| 100 | 1K | 100MB | 2C/2GB | 100MB |
| 1K | 10K | 200MB | 4C/8GB | 1GB |
| 10K | 100K | 500MB | 8C/16GB | 10GB |
| 100K | 1M | 1GB | 16C/32GB | 100GB |

#### 带宽消耗估算

```text
协议              | 单Span大小 | 1K spans/s带宽 | 10K spans/s带宽
------------------|-----------|----------------|----------------
gRPC              | ~1KB      | ~1MB/s         | ~10MB/s
HTTP/Protobuf     | ~1.2KB    | ~1.2MB/s       | ~12MB/s
HTTP/JSON         | ~2.5KB    | ~2.5MB/s       | ~25MB/s
```

### 优化建议检查清单

```text
□ SDK优化
  □ 启用批处理 (batch_size: 512)
  □ 合理采样率 (根据流量调整)
  □ 异步导出 (避免阻塞应用)
  □ 压缩传输 (gzip)

□ Collector优化
  □ 批处理配置 (send_batch_size: 8192)
  □ 内存限制器 (memory_limiter: 80%触发)
  □ 队列持久化 (persistent_queue)
  □ 并发导出 (sending_queue: num_consumers: 10)

□ 网络优化
  □ 使用gRPC协议
  □ 启用HTTP/2
  □ 压缩传输
  □ 就近部署Collector

□ 采样优化
  □ Head-based采样 (减少SDK负载)
  □ Tail-based采样 (保证重要trace)
  □ 自适应采样 (根据负载调整)

□ 存储优化
  □ 数据保留策略 (7-30天)
  □ 冷热分离
  □ 压缩存储
  □ 定期清理
```

---

## 配置模板速查

### 最小化配置

**Go SDK**:

```go
import (
    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracehttp"
    sdktrace "go.opentelemetry.io/otel/sdk/trace"
)

// 最小配置
exporter, _ := otlptracehttp.New(context.Background())
tp := sdktrace.NewTracerProvider(
    sdktrace.WithBatcher(exporter),
)
otel.SetTracerProvider(tp)
```

**环境变量配置**:

```bash
export OTEL_SERVICE_NAME=my-service
export OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
```

### 标准生产配置

**Go SDK**:

```go
// 生产配置
exporter, _ := otlptracehttp.New(
    context.Background(),
    otlptracehttp.WithEndpoint("collector:4318"),
    otlptracehttp.WithCompression(otlptracehttp.GzipCompression),
    otlptracehttp.WithTimeout(10*time.Second),
    otlptracehttp.WithRetry(otlptracehttp.RetryConfig{
        Enabled: true,
        InitialInterval: time.Second,
        MaxInterval: 30*time.Second,
        MaxElapsedTime: time.Minute,
    }),
)

tp := sdktrace.NewTracerProvider(
    sdktrace.WithBatcher(exporter,
        sdktrace.WithBatchTimeout(5*time.Second),
        sdktrace.WithMaxExportBatchSize(512),
        sdktrace.WithMaxQueueSize(2048),
    ),
    sdktrace.WithSampler(sdktrace.ParentBased(
        sdktrace.TraceIDRatioBased(0.1),
    )),
    sdktrace.WithResource(resource.NewWithAttributes(
        semconv.SchemaURL,
        semconv.ServiceName("my-service"),
        semconv.ServiceVersion("1.0.0"),
        semconv.DeploymentEnvironment("production"),
    )),
)
```

**Collector配置**:

```yaml
receivers:
  otlp:
    protocols:
      grpc:
        endpoint: 0.0.0.0:4317
      http:
        endpoint: 0.0.0.0:4318

processors:
  batch:
    send_batch_size: 1024
    timeout: 10s
  memory_limiter:
    check_interval: 1s
    limit_mib: 1000

exporters:
  otlp:
    endpoint: backend:4317
    sending_queue:
      enabled: true
      num_consumers: 10
      queue_size: 5000
    retry_on_failure:
      enabled: true
      initial_interval: 5s
      max_interval: 30s

service:
  pipelines:
    traces:
      receivers: [otlp]
      processors: [memory_limiter, batch]
      exporters: [otlp]
```

### 高可用配置

**Kubernetes Deployment**:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: otel-collector
spec:
  replicas: 3  # 高可用
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1
      maxSurge: 1
  template:
    spec:
      containers:
      - name: otel-collector
        image: otel/opentelemetry-collector-contrib:0.88.0
        resources:
          requests:
            cpu: 500m
            memory: 1Gi
          limits:
            cpu: 1000m
            memory: 2Gi
        env:
        - name: GOGC
          value: "80"
        livenessProbe:
          httpGet:
            path: /
            port: 13133
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /
            port: 13133
          initialDelaySeconds: 5
          periodSeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: otel-collector
spec:
  type: LoadBalancer
  ports:
  - name: otlp-grpc
    port: 4317
    targetPort: 4317
  - name: otlp-http
    port: 4318
    targetPort: 4318
  selector:
    app: otel-collector

---
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: otel-collector-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: otel-collector
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
```

---

## 常用命令集合

### Docker运行Collector

```bash
# 快速启动
docker run -p 4317:4317 -p 4318:4318 \
  otel/opentelemetry-collector-contrib:latest

# 使用自定义配置
docker run -v $(pwd)/config.yaml:/etc/otel/config.yaml \
  -p 4317:4317 -p 4318:4318 \
  otel/opentelemetry-collector-contrib:latest \
  --config=/etc/otel/config.yaml

# 完整配置
docker run \
  -v $(pwd)/config.yaml:/etc/otel/config.yaml \
  -p 4317:4317 -p 4318:4318 -p 13133:13133 \
  -e GOGC=80 \
  --name otel-collector \
  otel/opentelemetry-collector-contrib:latest \
  --config=/etc/otel/config.yaml
```

### Kubernetes部署

```bash
# 使用Helm
helm repo add open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts
helm install my-collector open-telemetry/opentelemetry-collector

# 查看状态
kubectl get pods -l app.kubernetes.io/name=opentelemetry-collector
kubectl logs -f deployment/my-collector-opentelemetry-collector

# 测试连接
kubectl port-forward svc/my-collector-opentelemetry-collector 4317:4317
```

### 测试与验证

```bash
# 使用telemetrygen生成测试数据
docker run --rm -it \
  ghcr.io/open-telemetry/opentelemetry-collector-contrib/telemetrygen:latest \
  traces --otlp-insecure --otlp-endpoint localhost:4317

# 使用curl测试HTTP端点
curl -X POST http://localhost:4318/v1/traces \
  -H "Content-Type: application/x-protobuf" \
  --data-binary @trace.pb

# 健康检查
curl http://localhost:13133/

# Metrics检查
curl http://localhost:8888/metrics
```

### 日志与调试

```bash
# 启用详细日志
docker run -e OTEL_LOG_LEVEL=debug \
  otel/opentelemetry-collector-contrib:latest

# 查看Collector日志
kubectl logs -f deployment/otel-collector

# 查看应用trace日志
export OTEL_LOG_LEVEL=debug
export OTEL_TRACES_EXPORTER=console
./myapp
```

---

## 故障排查速查

### 快速诊断命令

```bash
# 1. 检查Collector健康状态
curl http://localhost:13133/

# 2. 检查Collector指标
curl http://localhost:8888/metrics | grep otelcol

# 3. 检查网络连通性
telnet localhost 4317
nc -zv localhost 4317

# 4. 检查DNS解析
nslookup otel-collector
dig otel-collector

# 5. 测试TLS连接
openssl s_client -connect localhost:4317

# 6. 验证证书
openssl x509 -in cert.pem -text -noout
```

### 常见问题速查表

| 症状 | 可能原因 | 快速检查 | 解决方案文档 |
|------|---------|---------|-------------|
| **数据未上报** | 端点错误 | `curl http://collector:4318/` | [数据未上报诊断](./00_问题诊断决策树手册.md#数据未上报) |
| **连接超时** | 网络/防火墙 | `telnet collector 4317` | [连接问题诊断](./00_问题诊断决策树手册.md#连接问题) |
| **TLS错误** | 证书问题 | `openssl s_client -connect` | [TLS故障排查](./07_安全与合规/01_安全最佳实践.md) |
| **高延迟** | 批处理配置 | 检查`batch_timeout` | [性能优化](./05_采样与性能/02_性能优化实践.md) |
| **内存溢出** | 队列配置 | 检查`queue_size` | [Collector调优](./04_核心组件/02_Collector架构.md) |
| **数据丢失** | 采样/限流 | 检查`sampler`配置 | [采样策略](./05_采样与性能/01_采样策略.md) |

### 关键指标监控

```text
# Collector关键指标
otelcol_receiver_accepted_spans     # 接收的span数
otelcol_receiver_refused_spans      # 拒绝的span数
otelcol_exporter_sent_spans         # 发送的span数
otelcol_exporter_send_failed_spans  # 发送失败的span数
otelcol_processor_batch_batch_send_size  # 批次大小
otelcol_process_uptime               # 运行时间
otelcol_process_memory_rss           # 内存使用

# SDK关键指标（应用层）
tracer.created_spans                 # 创建的span数
exporter.exported_spans              # 导出的span数
exporter.failed_exports              # 导出失败数
exporter.queue_size                  # 队列大小
```

---

## 参考文档快速索引

### 按主题分类

**新手入门**:

- [快速开始指南](./快速开始指南.md)
- [协议概述](./01_OTLP核心协议/01_协议概述.md)
- [SDK概述](./04_核心组件/01_SDK概述.md)

**配置指南**:

- [Collector生产配置](./04_核心组件/06_Collector生产环境完整配置示例.md)
- [Collector Receiver配置](./04_核心组件/04_Collector_Receiver配置详解.md)
- [Collector Processor配置](./04_核心组件/03_Collector_Processor配置详解.md)
- [Collector Exporter配置](./04_核心组件/05_Collector_Exporter配置详解.md)

**故障排查**:

- [问题诊断决策树](./00_问题诊断决策树手册.md)
- [故障排查手册](./16_故障排查手册/01_OpenTelemetry故障排查完整手册.md)
- [常见问题解决方案](./08_故障排查/01_常见问题与解决方案.md)

**性能优化**:

- [采样策略](./05_采样与性能/01_采样策略.md)
- [性能优化实践](./05_采样与性能/02_性能优化实践.md)
- [性能基准测试](./14_性能与基准测试/01_OpenTelemetry性能基准测试.md)

**安全合规**:

- [安全最佳实践](./07_安全与合规/01_安全最佳实践.md)
- [安全加固指南](./15_安全加固指南/01_OpenTelemetry安全加固完整指南.md)
- [数据隐私合规](./07_安全与合规/02_数据隐私合规.md)

**实战案例**:

- [实战场景快速查找](./19_综合实战手册/01_OpenTelemetry实战场景快速查找指南.md)
- [微服务追踪实战](./06_实战案例/01_微服务追踪实战.md)
- [大规模电商实战](./06_实战案例/05_大规模电商系统可观测性实战.md)

---

## 贡献与反馈

如您发现本速查手册有任何问题或需要补充，欢迎提交Issue或PR。

---

**最后更新**: 2025年10月8日  
**维护者**: OTLP深度梳理项目组  
**版本**: v1.0

[🏠 返回首页](./README.md) | [📖 完整文档索引](./00_快速导航_完整索引.md)
