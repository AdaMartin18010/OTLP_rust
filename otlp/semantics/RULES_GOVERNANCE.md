# OTTL 規則治理（全生命週期）

## 1. 目標

- 安全、可回滾、可審計；控制高基數與成本；避免規則蠕變與衝突

## 2. 角色與責任

- 規則所有者（業務/平台）
- 審核人（SRE/安全/合規）
- 發布人（管控平面/自動化）

## 3. 工作流

- 草擬 → 靜態檢查（語法/黑白名單/高基數預估） → 小流量灰度（標籤/權重/窗口） → 觀測驗證 → 放量 → 存檔

## 4. 靜態檢查

- 禁止/限制函數名單；屬性白名單；單位/命名規範；高基數鍵估算與門檻

## 5. 灰度與回滾

- 策略：標籤選擇器、分批放量、最大失敗率、觀測門檻
- 自動回滾：失敗率/資源/延遲超閾值 → 回滾到上一版本 ConfigHash

## 6. 觀測與驗證

- 指標：accepted/exported/failed spans、CPU/RSS、後端錯誤
- 面板與告警：標準化看板 + SLO 告警規則

## 7. 存檔與審計

- 版本、變更原因、審批記錄、基準與演練證據、回滾點

## 8. 工具化

- lint（規則靜態檢查）、灰度編排、回滾自動化、基準與報表
